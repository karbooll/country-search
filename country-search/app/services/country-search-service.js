'use strict'

angular.module("CountrySearch")
    .factory("countrySearchService", ['$http', '$q', function ($http, $q) {

        return {
            search: search,
            send: send
        }

        function send(countries) {

            var isoCodes = _.map(countries, 'isoCode');

            // return $http({
            //     method: 'POST',
            //     url: '/selectedCountries',
            //     data: { isoCodes: isoCodes }
            // }).then(function (response) {
            //     toastr.success("List of countries has been succesfully submited.");
            // }, function (errorResponse) {
            //     if (errorResponse.status == 404)
            //         return;

            //     toastr.error("An error has occurred. Please contact your system administrator...");
            // });

            toastr.success("List of countries has been succesfully submited.");
            return $q.resolve();            
        }

        function search(searchStr) {

            // return $http({
            //     method: 'GET',
            //     url: '/country',
            //     params: { search: searchStr }
            // }).then(function (response) {

            // }, function (errorResponse) {
            //     if (errorResponse.status == 404)
            //         return;

            //     toastr.error("It was not possible to fetch list of countries at this time...");
            // });

            var countries = [
                { name: "Afghanistan", isoCode: "AFG" },
                { name: "Aland Islands", isoCode: "ALA" },
                { name: "Albania", isoCode: "ALB" },
                { name: "Algeria", isoCode: "DZA" },
                { name: "American Samoa", isoCode: "ASM" },
                { name: "Andorra", isoCode: "AND" },
                { name: "Angola", isoCode: "AGO" },
                { name: "Anguilla", isoCode: "AIA" },
                { name: "Antarctica", isoCode: "ATA" },
                { name: "Antigua and Barbuda", isoCode: "ATG" },
                { name: "Argentina", isoCode: "ARG" },
                { name: "Armenia", isoCode: "ARM" },
                { name: "Aruba", isoCode: "ABW" },
                { name: "Australia", isoCode: "AUS" },
                { name: "Austria", isoCode: "AUT" },
                { name: "Azerbaijan", isoCode: "AZE" },
                { name: "Bahamas", isoCode: "BHS" },
                { name: "Bahrain", isoCode: "BHR" },
                { name: "Bangladesh", isoCode: "BGD" },
                { name: "Barbados", isoCode: "BRB" },
                { name: "Belarus", isoCode: "BLR" },
                { name: "Belgium", isoCode: "BEL" },
                { name: "Belize", isoCode: "BLZ" },
                { name: "Benin", isoCode: "BEN" },
                { name: "Bermuda", isoCode: "BMU" },
                { name: "Bhutan", isoCode: "BTN" },
                { name: "Bolivia", isoCode: "BOL" },
                { name: "Bosnia and Herzegovina", isoCode: "BIH" },
                { name: "Botswana", isoCode: "BWA" },
                { name: "Bouvet Island", isoCode: "BVT" },
                { name: "Brazil", isoCode: "BRA" },
                { name: "British Virgin Islands", isoCode: "VGB" },
                { name: "British Indian Ocean Territory", isoCode: "IOT" },
                { name: "Brunei Darussalam", isoCode: "BRN" },
                { name: "Bulgaria", isoCode: "BGR" },
                { name: "Burkina Faso", isoCode: "BFA" },
                { name: "Burundi", isoCode: "BDI" },
                { name: "Cambodia", isoCode: "KHM" },
                { name: "Cameroon", isoCode: "CMR" },
                { name: "Canada", isoCode: "CAN" },
                { name: "Cape Verde", isoCode: "CPV" },
                { name: "Cayman Islands", isoCode: "CYM" },
                { name: "Central African Republic", isoCode: "CAF" },
                { name: "Chad", isoCode: "TCD" },
                { name: "Chile", isoCode: "CHL" },
                { name: "China", isoCode: "CHN" },
                { name: "Hong Kong, SAR China", isoCode: "HKG" },
                { name: "Macao, SAR China", isoCode: "MAC" },
                { name: "Christmas Island", isoCode: "CXR" },
                { name: "Cocos (Keeling) Islands", isoCode: "CCK" },
                { name: "Colombia", isoCode: "COL" },
                { name: "Comoros", isoCode: "COM" },
                { name: "Congo (Brazzaville)", isoCode: "COG" },
                { name: "Congo, (Kinshasa)", isoCode: "COD" },
                { name: "Cook Islands", isoCode: "COK" },
                { name: "Costa Rica", isoCode: "CRI" },
                { name: "CÃ´te d'Ivoire", isoCode: "CIV" },
                { name: "Croatia", isoCode: "HRV" },
                { name: "Cuba", isoCode: "CUB" },
                { name: "Cyprus", isoCode: "CYP" },
                { name: "Czech Republic", isoCode: "CZE" },
                { name: "Denmark", isoCode: "DNK" },
                { name: "Djibouti", isoCode: "DJI" },
                { name: "Dominica", isoCode: "DMA" },
                { name: "Dominican Republic", isoCode: "DOM" },
                { name: "Ecuador", isoCode: "ECU" },
                { name: "Egypt", isoCode: "EGY" },
                { name: "El Salvador", isoCode: "SLV" },
                { name: "Equatorial Guinea", isoCode: "GNQ" },
                { name: "Eritrea", isoCode: "ERI" },
                { name: "Estonia", isoCode: "EST" },
                { name: "Ethiopia", isoCode: "ETH" },
                { name: "Falkland Islands (Malvinas)", isoCode: "FLK" },
                { name: "Faroe Islands", isoCode: "FRO" },
                { name: "Fiji", isoCode: "FJI" },
                { name: "Finland", isoCode: "FIN" },
                { name: "France", isoCode: "FRA" },
                { name: "French Guiana", isoCode: "GUF" },
                { name: "French Polynesia", isoCode: "PYF" },
                { name: "French Southern Territories", isoCode: "ATF" },
                { name: "Gabon", isoCode: "GAB" },
                { name: "Gambia", isoCode: "GMB" },
                { name: "Georgia", isoCode: "GEO" },
                { name: "Germany", isoCode: "DEU" },
                { name: "Ghana", isoCode: "GHA" },
                { name: "Gibraltar", isoCode: "GIB" },
                { name: "Greece", isoCode: "GRC" },
                { name: "Greenland", isoCode: "GRL" },
                { name: "Grenada", isoCode: "GRD" },
                { name: "Guadeloupe", isoCode: "GLP" },
                { name: "Guam", isoCode: "GUM" },
                { name: "Guatemala", isoCode: "GTM" },
                { name: "Guernsey", isoCode: "GGY" },
                { name: "Guinea", isoCode: "GIN" },
                { name: "Guinea-Bissau", isoCode: "GNB" },
                { name: "Guyana", isoCode: "GUY" },
                { name: "Haiti", isoCode: "HTI" },
                { name: "Heard and Mcdonald Islands", isoCode: "HMD" },
                { name: "Holy See (Vatican City State)", isoCode: "VAT" },
                { name: "Honduras", isoCode: "HND" },
                { name: "Hungary", isoCode: "HUN" },
                { name: "Iceland", isoCode: "ISL" },
                { name: "India", isoCode: "IND" },
                { name: "Indonesia", isoCode: "IDN" },
                { name: "Iran, Islamic Republic of", isoCode: "IRN" },
                { name: "Iraq", isoCode: "IRQ" },
                { name: "Ireland", isoCode: "IRL" },
                { name: "Isle of Man", isoCode: "IMN" },
                { name: "Israel", isoCode: "ISR" },
                { name: "Italy", isoCode: "ITA" },
                { name: "Jamaica", isoCode: "JAM" },
                { name: "Japan", isoCode: "JPN" },
                { name: "Jersey", isoCode: "JEY" },
                { name: "Jordan", isoCode: "JOR" },
                { name: "Kazakhstan", isoCode: "KAZ" },
                { name: "Kenya", isoCode: "KEN" },
                { name: "Kiribati", isoCode: "KIR" },
                { name: "Korea (North)", isoCode: "PRK" },
                { name: "Korea (South)", isoCode: "KOR" },
                { name: "Kuwait", isoCode: "KWT" },
                { name: "Kyrgyzstan", isoCode: "KGZ" },
                { name: "Lao PDR", isoCode: "LAO" },
                { name: "Latvia", isoCode: "LVA" },
                { name: "Lebanon", isoCode: "LBN" },
                { name: "Lesotho", isoCode: "LSO" },
                { name: "Liberia", isoCode: "LBR" },
                { name: "Libya", isoCode: "LBY" },
                { name: "Liechtenstein", isoCode: "LIE" },
                { name: "Lithuania", isoCode: "LTU" },
                { name: "Luxembourg", isoCode: "LUX" },
                { name: "Macedonia, Republic of", isoCode: "MKD" },
                { name: "Madagascar", isoCode: "MDG" },
                { name: "Malawi", isoCode: "MWI" },
                { name: "Malaysia", isoCode: "MYS" },
                { name: "Maldives", isoCode: "MDV" },
                { name: "Mali", isoCode: "MLI" },
                { name: "Malta", isoCode: "MLT" },
                { name: "Marshall Islands", isoCode: "MHL" },
                { name: "Martinique", isoCode: "MTQ" },
                { name: "Mauritania", isoCode: "MRT" },
                { name: "Mauritius", isoCode: "MUS" },
                { name: "Mayotte", isoCode: "MYT" },
                { name: "Mexico", isoCode: "MEX" },
                { name: "Micronesia, Federated States of", isoCode: "FSM" },
                { name: "Moldova", isoCode: "MDA" },
                { name: "Monaco", isoCode: "MCO" },
                { name: "Mongolia", isoCode: "MNG" },
                { name: "Montenegro", isoCode: "MNE" },
                { name: "Montserrat", isoCode: "MSR" },
                { name: "Morocco", isoCode: "MAR" },
                { name: "Mozambique", isoCode: "MOZ" },
                { name: "Myanmar", isoCode: "MMR" },
                { name: "Namibia", isoCode: "NAM" },
                { name: "Nauru", isoCode: "NRU" },
                { name: "Nepal", isoCode: "NPL" },
                { name: "Netherlands", isoCode: "NLD" },
                { name: "Netherlands Antilles", isoCode: "ANT" },
                { name: "New Caledonia", isoCode: "NCL" },
                { name: "New Zealand", isoCode: "NZL" },
                { name: "Nicaragua", isoCode: "NIC" },
                { name: "Niger", isoCode: "NER" },
                { name: "Nigeria", isoCode: "NGA" },
                { name: "Niue", isoCode: "NIU" },
                { name: "Norfolk Island", isoCode: "NFK" },
                { name: "Northern Mariana Islands", isoCode: "MNP" },
                { name: "Norway", isoCode: "NOR" },
                { name: "Oman", isoCode: "OMN" },
                { name: "Pakistan", isoCode: "PAK" },
                { name: "Palau", isoCode: "PLW" },
                { name: "Palestinian Territory", isoCode: "PSE" },
                { name: "Panama", isoCode: "PAN" },
                { name: "Papua New Guinea", isoCode: "PNG" },
                { name: "Paraguay", isoCode: "PRY" },
                { name: "Peru", isoCode: "PER" },
                { name: "Philippines", isoCode: "PHL" },
                { name: "Pitcairn", isoCode: "PCN" },
                { name: "Poland", isoCode: "POL" },
                { name: "Portugal", isoCode: "PRT" },
                { name: "Puerto Rico", isoCode: "PRI" },
                { name: "Qatar", isoCode: "QAT" },
                { name: "RÃ©union", isoCode: "REU" },
                { name: "Romania", isoCode: "ROU" },
                { name: "Russian Federation", isoCode: "RUS" },
                { name: "Rwanda", isoCode: "RWA" },
                { name: "Saint-BarthÃ©lemy", isoCode: "BLM" },
                { name: "Saint Helena", isoCode: "SHN" },
                { name: "Saint Kitts and Nevis", isoCode: "KNA" },
                { name: "Saint Lucia", isoCode: "LCA" },
                { name: "Saint-Martin (French part)", isoCode: "MAF" },
                { name: "Saint Pierre and Miquelon", isoCode: "SPM" },
                { name: "Saint Vincent and Grenadines", isoCode: "VCT" },
                { name: "Samoa", isoCode: "WSM" },
                { name: "San Marino", isoCode: "SMR" },
                { name: "Sao Tome and Principe", isoCode: "STP" },
                { name: "Saudi Arabia", isoCode: "SAU" },
                { name: "Senegal", isoCode: "SEN" },
                { name: "Serbia", isoCode: "SRB" },
                { name: "Seychelles", isoCode: "SYC" },
                { name: "Sierra Leone", isoCode: "SLE" },
                { name: "Singapore", isoCode: "SGP" },
                { name: "Slovakia", isoCode: "SVK" },
                { name: "Slovenia", isoCode: "SVN" },
                { name: "Solomon Islands", isoCode: "SLB" },
                { name: "Somalia", isoCode: "SOM" },
                { name: "South Africa", isoCode: "ZAF" },
                { name: "South Georgia and the South Sandwich Islands", isoCode: "SGS" },
                { name: "South Sudan", isoCode: "SSD" },
                { name: "Spain", isoCode: "ESP" },
                { name: "Sri Lanka", isoCode: "LKA" },
                { name: "Sudan", isoCode: "SDN" },
                { name: "Suriname", isoCode: "SUR" },
                { name: "Svalbard and Jan Mayen Islands", isoCode: "SJM" },
                { name: "Swaziland", isoCode: "SWZ" },
                { name: "Sweden", isoCode: "SWE" },
                { name: "Switzerland", isoCode: "CHE" },
                { name: "Syrian Arab Republic (Syria)", isoCode: "SYR" },
                { name: "Taiwan, Republic of China", isoCode: "TWN" },
                { name: "Tajikistan", isoCode: "TJK" },
                { name: "Tanzania, United Republic of", isoCode: "TZA" },
                { name: "Thailand", isoCode: "THA" },
                { name: "Timor-Leste", isoCode: "TLS" },
                { name: "Togo", isoCode: "TGO" },
                { name: "Tokelau", isoCode: "TKL" },
                { name: "Tonga", isoCode: "TON" },
                { name: "Trinidad and Tobago", isoCode: "TTO" },
                { name: "Tunisia", isoCode: "TUN" },
                { name: "Turkey", isoCode: "TUR" },
                { name: "Turkmenistan", isoCode: "TKM" },
                { name: "Turks and Caicos Islands", isoCode: "TCA" },
                { name: "Tuvalu", isoCode: "TUV" },
                { name: "Uganda", isoCode: "UGA" },
                { name: "Ukraine", isoCode: "UKR" },
                { name: "United Arab Emirates", isoCode: "ARE" },
                { name: "United Kingdom", isoCode: "GBR" },
                { name: "United States of America", isoCode: "USA" },
                { name: "US Minor Outlying Islands", isoCode: "UMI" },
                { name: "Uruguay", isoCode: "URY" },
                { name: "Uzbekistan", isoCode: "UZB" },
                { name: "Vanuatu", isoCode: "VUT" },
                { name: "Venezuela (Bolivarian Republic)", isoCode: "VEN" },
                { name: "Viet Nam", isoCode: "VNM" },
                { name: "Virgin Islands, US", isoCode: "VIR" },
                { name: "Wallis and Futuna Islands", isoCode: "WLF" },
                { name: "Western Sahara", isoCode: "ESH" },
                { name: "Yemen", isoCode: "YEM" },
                { name: "Zambia", isoCode: "ZMB" },
                { name: "Zimbabwe", isoCode: "ZWE" }
            ];

            return _
                .chain(countries)
                .filter(function (v) {
                    return _.startsWith(v.name.toLowerCase(), searchStr.toLowerCase())
                })
                .value();

        }
    }]);    